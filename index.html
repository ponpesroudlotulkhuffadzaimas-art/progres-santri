<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Progres Santri</title>

<style>
body{font-family:Arial;background:#f5f5f5;margin:0}
header{background:#1e88e5;color:white;padding:12px;text-align:center}
.container{padding:15px}
input,select,button{width:100%;padding:10px;margin-top:5px;margin-bottom:10px;font-size:15px}
button{background:#1e88e5;color:white;border:none;border-radius:5px}
table{width:100%;border-collapse:collapse;margin-top:10px;background:white}
th,td{border:1px solid #ccc;padding:6px;font-size:13px;text-align:center}
th{background:#1976d2;color:white}
.loading{display:none;text-align:center;padding:10px}
</style>

</head>

<body>

<header>
<h3>Catatan Progres Santri</h3>
</header>

<div class="container">

<div class="loading" id="loading">‚è≥ Memuat data...</div>

<input type="text" id="nama" placeholder="Nama Santri">
<select id="kelas">
<option value="">Pilih Kelas</option>
<option>1</option>
<option>2</option>
<option>3</option>
<option>4</option>
<option>5</option>
<option>6</option>
</select>
<input type="text" id="hafalan" placeholder="Hafalan / Progres">

<button onclick="simpan()">Simpan</button>

<table>
<thead>
<tr>
<th>No</th>
<th>Nama</th>
<th>Kelas</th>
<th>Progres</th>
<th>Tanggal</th>
</tr>
</thead>
<tbody id="data"></tbody>
</table>

</div>

<script>

const URL_API = "GANTI_DENGAN_URL_WEB_APP_ANDA";

function showLoading(v){
  document.getElementById('loading').style.display = v ? 'block' : 'none';
}

async function loadData(){
  showLoading(true);
  try{
    const res = await fetch(URL_API + "?action=get");
    const json = await res.json();

    let html = "";
    json.data.forEach((d,i)=>{
      html += `<tr>
        <td>${i+1}</td>
        <td>${d.nama}</td>
        <td>${d.kelas}</td>
        <td>${d.hafalan}</td>
        <td>${d.tanggal}</td>
      </tr>`;
    });

    document.getElementById('data').innerHTML = html;
  }catch(e){
    alert("Gagal mengambil data");
    console.error(e);
  }
  showLoading(false);
}

async function simpan(){
  const nama = document.getElementById("nama").value;
  const kelas = document.getElementById("kelas").value;
  const hafalan = document.getElementById("hafalan").value;

  if(!nama || !kelas || !hafalan){
    alert("Lengkapi data!");
    return;
  }

  showLoading(true);

  try{
    const res = await fetch(URL_API, {
      method: "POST",
      headers: {"Content-Type":"application/json"},
      body: JSON.stringify({
        action: "add",
        nama: nama,
        kelas: kelas,
        hafalan: hafalan
      })
    });

    const json = await res.json();

    if(json.status=="OK"){
      alert("Data berhasil disimpan");
      document.getElementById("nama").value="";
      document.getElementById("kelas").value="";
      document.getElementById("hafalan").value="";
      loadData();
    }else{
      alert("Gagal menyimpan");
    }

  }catch(e){
    alert("Error simpan data");
    console.error(e);
  }

  showLoading(false);
}

loadData();

</script>

</body>
</html>
